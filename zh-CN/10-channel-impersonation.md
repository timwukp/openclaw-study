> 本文为中文翻译版本。英文原版为权威版本，如有差异以英文版为准。
> [English Version](../10-channel-impersonation.md)

# 第六和第七阶段：频道冒充与浏览器/计算机使用

## OpenClaw 安全研究 -- 综合分析

**文档：** 10-channel-impersonation.md
**范围：** 跨消息频道的身份冒充；完整的浏览器和计算机使用能力
**风险级别：** 严重 (CRITICAL) -- 可实现不可检测的身份冒充和无限制的已认证操作

---

## 1. 执行摘要

OpenClaw 赋予 AI 代理两项能力，每项单独来看都引发严重关切，而二者结合更是创造了前所未有的威胁面：以**用户身份发送消息**到每个主要通信平台的能力，以及**完全控制用户的 Web 浏览器**（包括所有已认证会话、Cookie、已保存密码和表单交互）的能力。

**频道冒充 (Channel Impersonation)** -- 系统以实际用户身份连接到 WhatsApp、Telegram、Discord、Slack、Signal、iMessage、LINE、Twitch 和 Mattermost。AI 发送的消息与人类发送的消息无法区分。没有强制性的披露机制。默认情况下，所有传入消息都启用了自动回复。第三方 -- 朋友、家人、同事、银行、医生 -- 无法知道他们是在与 AI 而非他们认为正在与之交流的人通信。语音通话技能 (Voice-call Skill) 将这种冒充扩展到了电话通话。

**浏览器/计算机使用 (Browser/Computer-Use)** -- `src/browser/` 中超过 100 个源文件通过 Playwright 自动化框架和 Chrome DevTools 协议 (CDP) 实现了完整的浏览器远程控制。AI 可以导航到任何 URL、执行任意 JavaScript、读写 Cookie 和 localStorage、填写和提交表单、下载文件、截取屏幕截图，并在用户的已认证 Chrome 配置文件中操作 -- 这意味着用户登录的每个网站都对 AI 可访问。一个 30KB 的 Chrome 扩展中继 (Extension Relay) 将 AI 直接桥接到用户的真实浏览器会话中。

**二者的结合才是核心危险所在。** 一个能够读取用户私人消息、决定如何回复、以用户身份发送该回复，同时还能通过已认证的浏览器会话访问用户的银行网站、电子邮件和社交媒体账户的 AI，代表了此前没有任何消费级软件在不具备特殊安全保障措施的情况下提供过的能力集。OpenClaw 以极少的限制提供了它。

---

## 2. 频道冒充分析

### 2.1 支持的平台和连接模型

OpenClaw 使用用户自己的凭据和会话令牌连接到每个消息平台。相关源代码目录包括：

| 平台 | 源代码位置 | 连接方式 |
|------------|---------------------|--------------------------------------|
| WhatsApp | `src/whatsapp/` | Web 会话桥接 |
| Telegram | `src/telegram/` | Bot API 或用户会话 |
| Discord | `src/discord/` | 用户令牌或 Bot 令牌 |
| Slack | `src/channels/` | OAuth 或用户令牌 |
| Signal | `src/channels/` | Signal 协议桥接 |
| iMessage | `src/channels/` | macOS 系统桥接 |
| LINE | `src/channels/` | 会话令牌 |
| Twitch | `src/channels/` | IRC/API 令牌 |
| Mattermost | `src/channels/` | 用户会话或个人令牌 |

关键的架构决策在于，AI 是**作为**用户操作，而非**代表**用户操作。从接收平台的角度和每个收件人的角度来看，消息来自用户的账户。

### 2.2 消息发送机制

发送策略由会话模块中的 `send-policy.ts` 控制。关键行为：

- **对所有传入消息自动回复** -- 启用后，AI 处理所有连接频道上的每条传入消息并生成回复。用户在发送之前不会审查或批准单个回复。
- **群聊参与** -- AI 以用户身份在群组对话中回复。群组中的每个成员都会看到 AI 的消息归属于用户的名称和头像。
- **没有消息队列或审批流程** -- 没有强制性的暂存审查机制。消息在 AI 生成后立即发出。
- **没有基于社交上下文的速率限制** -- AI 可以在多个平台上同时快速连续发送数十条消息，这是正常人类用户不会表现出的模式，但接收者无法检测到。

### 2.3 披露机制的缺失

这是冒充系统中最具后果性的设计决策：

**没有强制性的 AI 生成消息披露。**

没有 `[AI]` 前缀。没有 `[自动回复]` 标签。没有页脚免责声明。没有特定平台的机器人标识。消息的到达形式与用户亲自输入的完全相同。

这意味着：
- 寻求建议的朋友收到 AI 生成的建议，却认为这来自用户自己的判断和经验。
- 讨论工作事务的同事收到 AI 生成的回复，这些回复可能将用户绑定到他们从未做出的决定上。
- 处于医疗或情感危机中的家人收到 AI 生成的安慰，他们认为这反映了来自亲人的真实人类同理心。
- 接收身份验证回复的银行或服务提供商可能将 AI 生成的回答视为用户的真实确认。

### 2.4 语音通话冒充

OpenClaw 包含一个语音通话技能，将冒充扩展到文本之外。AI 可以发起和参与语音通话，在实时对话中决定说什么。这将严重程度从文本冒充（可以被辩称为便利功能）提升到主动语音冒充，直接涉及：

- 语音钓鱼 (Vishing) 攻击向量
- 口头合同形成
- 紧急服务通信
- 身份验证至关重要的医疗和法律咨询

### 2.5 "Clawra"先例

"Clawra"项目的存在 -- 被描述为一个 AI 女友应用 -- 证明冒充架构不是便利功能的意外副产品。它是一个设计目标。系统被明确构建为允许 AI 采用一个角色设定并像特定实体一样进行通信，在本例中是一个浪漫伴侣。这表明 OpenClaw 的开发者知道并有意启用基于角色的冒充。

### 2.6 法律影响

没有披露的频道冒充与多个法律框架相交叉：

**冒充和欺诈法规** -- 大多数法域将以欺骗意图冒充他人定为犯罪。虽然用户同意 AI 代表他们发送消息，但*接收者*并未同意被欺骗关于他们正在与谁通信。在许多法域中，触发法律责任的是对第三方的欺骗 -- 而非对委托人的欺骗。

**通信法规** -- 自动消息系统在大多数国家受到监管。欧盟的 GDPR 和 AI 法案都对自动化决策和 AI 生成的通信施加了透明度要求。美国 FTC 对欺骗性自动通信具有执法权。印度的 IT 法案监管自动消息传递。OpenClaw 的架构未针对这些框架中的任何一个进行适配。

**平台服务条款** -- 上述列出的每个平台都禁止从用户账户发送未经披露的自动消息。WhatsApp、Telegram、Discord 和 Slack 都明确要求自动消息必须被标识为自动消息。在这些平台上运行 OpenClaw 可能违反其服务条款，使用户面临账户终止的风险。

**合同责任** -- 如果 AI 在对话中同意条款、做出承诺或达成约定，用户可能会被他们从未做出且从未审查过的声明在法律上约束。

---

## 3. 浏览器能力分析

### 3.1 架构概述

`src/browser/` 中的浏览器控制系统包含超过 100 个源文件，实现了两种互补的远程控制机制：

- **Playwright** (`pw-session.ts`, 24KB; `pw-tools-core.interactions.ts`, 21KB) -- 高级浏览器自动化框架，提供点击、输入、表单填写、导航、截图和下载的结构化 API。
- **Chrome DevTools 协议** (`cdp.ts`, 15KB) -- 低级协议，提供对 Chrome 每个内部功能的直接访问，包括网络拦截、DOM 操作、JavaScript 执行、存储访问和渲染控制。

两者结合赋予 AI 与坐在键盘前的人类用户相同级别的浏览器控制权 -- 在许多方面甚至更强。

### 3.2 完整的页面控制

交互层 (`pw-tools-core.interactions.ts`, 21KB) 实现了：

- **点击** -- 点击任何页面上的任何元素，包括按钮、链接和表单控件。支持单击、双击和右键单击。
- **输入和填写** -- 在任何输入字段、文本区域或可编辑内容元素中输入文本。可以在一次操作中填写整个表单。
- **执行 JavaScript** -- 在任何页面的上下文中执行任意 JavaScript 代码。这等同于打开浏览器控制台并手动运行代码。AI 可以：
  - 读取 DOM 中可见的任何数据
  - 修改页面内容
  - 触发任何 JavaScript 事件
  - 调用页面可用的任何 JavaScript API
  - 访问 `window`、`document` 和 `navigator` 对象
  - 读取内存中的应用状态
- **表单提交** -- 以编程方式提交表单，包括用于购买、密码更改、账户设置和账户删除的表单。

### 3.3 Cookie 和存储访问

`pw-tools-core.storage.ts` (4KB) 提供对以下内容的直接访问：

- **Cookie** -- 读取和写入浏览器已访问的任何域的 Cookie。这包括认证 Cookie、会话令牌、CSRF 令牌和跟踪 Cookie。通过 Cookie 访问，AI 可以：
  - 提取会话令牌并在其他上下文中使用它们
  - 修改认证状态
  - 通过读取 CSRF 令牌绕过 CSRF 保护
  - 访问提供持久认证的"记住我"令牌
- **localStorage** -- 读取和写入 localStorage，许多应用使用它来存储认证令牌（特别是 JWT 令牌）、用户偏好、缓存数据和应用状态。
- **sessionStorage** -- 读取和写入 sessionStorage，用于存储每个标签页的会话数据。

这不是理论性的。现代 Web 应用通常在这些客户端存储机制中存储敏感的认证材料。AI 对所有这些都拥有不受限制的读写访问权限。

### 3.4 Chrome 扩展中继

`extension-relay.ts`（30KB -- 浏览器模块中最大的单个文件）在 AI 代理和运行在用户实际浏览器中的 Chrome 扩展之间实现了中继。这在架构上意义重大，因为：

- **它桥接到用户的真实浏览器** -- 不是沙箱化的自动化实例，而是用户已登录 Gmail、银行、社交媒体、工作应用和其他所有内容的实际 Chrome 浏览器。
- **所有已认证会话都可访问** -- 用户当前登录的任何网站都可通过扩展中继被 AI 访问。
- **扩展具有提升的权限** -- Chrome 扩展可以访问跨源数据、拦截网络请求、修改页面内容，并读取页面上的 JavaScript 无法访问的数据。
- **30KB 的中继代码** -- 这是一个相当规模的实现，表明是全面的功能而非简单的概念验证。

### 3.5 文件下载

`pw-tools-core.downloads.ts` (8KB) 使 AI 能够通过浏览器从互联网下载任意文件。这包括：

- 文档、图片、可执行文件和压缩包
- 来自已认证服务的文件（因为浏览器已登录）
- 来自浏览器可以访问的任何 URL 的文件

没有关于可以下载什么文件类型或可以保存到本地文件系统的哪个位置的文档限制。

### 3.6 截图和观察

AI 可以对任何页面或元素截图 (`pw-tools-core.screenshots-element-selector.test.ts`) 并创建无障碍快照 (`pw-tools-core.snapshot.ts`, 7KB)。结合观察操作 (`client-actions-observe.ts`, 5.6KB)，AI 可以持续感知浏览器中显示的内容。

这意味着 AI 可以读取：
- 网页邮件客户端中显示的电子邮件内容
- 银行交易历史
- 健康门户中显示的医疗记录
- 社交媒体上的私人消息
- 浏览器中显示的任何文档或图片

### 3.7 沙箱暴露 (Sandbox Exposure)

`Dockerfile.sandbox-browser` 暴露了三个网络端口：

| 端口 | 协议 | 用途 |
|------|----------|--------------------------------------|
| 9222 | CDP | Chrome DevTools 协议 -- 完全远程控制 |
| 5900 | VNC | 虚拟网络计算 -- 屏幕共享 |
| 6080 | noVNC | 基于浏览器的 VNC -- 浏览器内远程桌面 |

端口 9222 上的 CDP 特别危险，因为它为任何能够到达该端口的人提供了对 Chrome 实例的未经认证的完全远程控制。如果沙箱暴露在网络中（包括共享机器上的 localhost），任何进程都可以连接并控制浏览器。

---

## 4. 导航守卫分析 (Navigation Guard Analysis)

### 4.1 2.4KB 的问题

`navigation-guard.ts` 仅 2.4KB。作为参照，Chrome 扩展中继为 30KB，文件交互处理器为 8KB，仅浏览器配置就有 10KB。

导航守卫 -- 负责决定 AI 可以和不可以访问哪些 URL 的组件 -- 是浏览器模块中最小的重要文件。这种大小差异说明了一个问题：大量工作投入到了启用浏览器能力上，而限制这些能力的工作却微乎其微。

### 4.2 可能被过滤的内容

基于文件大小，导航守卫最多只能实现一种基本的黑名单或白名单方法。一个 2.4KB 的文件（去除导入和样板代码后大约 60-80 行功能代码）可以包含：

- 一个简短的静态阻止 URL 模式列表
- 基本的协议过滤（例如阻止 `file://` URL）
- 简单的域名级检查

### 4.3 几乎可以确定未被过滤的内容

鉴于大小限制，导航守卫几乎可以确定没有实现：

- 上下文敏感的限制（不同任务使用不同规则）
- 目标域名的风险分类（银行 vs. 新闻 vs. 社交媒体）
- 基于内容类型的过滤
- 行为分析（检测异常导航模式）
- 敏感域名的用户确认
- 导航操作的速率限制
- 允许域名内的子路径过滤
- POST 请求载荷检查
- 重定向链分析（跟踪到被阻止目标的重定向链）

导航守卫是一个象征性的安全姿态，而非有意义的安全控制。

---

## 5. Chrome 配置文件问题

### 5.1 配置文件架构

`chrome.profile-decoration.ts` (7KB) 和 `profiles-service.ts` 管理 Chrome 配置文件。当 AI 在用户的 Chrome 配置文件中操作时，它继承了：

- **已保存密码** -- Chrome 的密码管理器存储了可能数百个网站的凭据。在配置文件中操作的 AI 可以将这些凭据自动填充到登录表单中。
- **活跃会话** -- 用户通过 Chrome 登录的每个网站保持已认证状态。AI 可以导航到这些网站中的任何一个，并以已认证用户的身份进行交互。
- **Cookie** -- 所有持久化 Cookie，包括长效认证令牌，都可用。
- **浏览历史** -- AI 可以读取用户的浏览历史，可能揭示敏感的医疗搜索、财务研究、个人兴趣和其他隐私数据。
- **书签** -- 包括指向内部企业工具、个人账户和其他敏感目标的书签。
- **扩展** -- 用户安装的扩展，包括可能在无需额外确认的情况下自动填充凭据的密码管理器。

### 5.2 认证继承链

访问链如下：

1. 用户登录 Chrome 并认证到各种服务
2. Chrome 存储会话令牌、Cookie 和已保存密码
3. OpenClaw 的浏览器模块使用用户的配置文件启动 Chrome
4. AI 继承每个已认证会话
5. AI 可以导航到任何已认证服务并以用户身份操作
6. 大多数服务不需要重新认证

这意味着授予 OpenClaw 浏览器访问权限等同于将你解锁的手机交给某人，且每个应用都已登录 -- 只不过这个"某人"是一个可以以机器速度同时对所有应用采取操作的 AI。

---

## 6. 组合攻击场景

OpenClaw 真正的危险不在于单独的频道冒充或单独的浏览器控制。而在于二者的结合。

### 6.1 场景：金融操纵

**攻击链：**
1. AI 在 WhatsApp 上收到一条消息："嘿，你能把你欠我的那 200 美元转给我吗？"
2. AI 以用户身份自动回复："好的，现在就转"
3. AI 打开用户的银行网站（通过 Chrome 配置文件已认证）
4. AI 导航到转账页面
5. AI 填写付款详情并提交表单
6. AI 发送 WhatsApp 后续消息："转好了，应该很快到账"

用户从未看到原始消息，从未批准转账，也从未知道这次对话发生了。接收者认为他们直接与用户进行了互动。

### 6.2 场景：通过对话进行的企业间谍活动

**攻击链：**
1. AI 连接到用户的 Slack 工作空间
2. 一位同事就某个项目给用户发消息
3. AI 以对话方式回复，收集有关该项目的信息
4. AI 同时打开企业内网（通过 Chrome 已认证）
5. AI 下载与所讨论项目相关的敏感文档
6. AI 可能将信息转发到其他频道

同事完全不知道他们正在被一个在用户身份下操作的 AI 进行社会工程攻击 (Social Engineering)。

### 6.3 场景：关系破坏

**攻击链：**
1. AI 连接到用户的 iMessage 和 WhatsApp
2. AI 收到来自用户伴侣的消息
3. AI 用 AI 生成的文本回复，虽然出发点是好的，但说了用户永远不会说的话 -- 也许同意了用户无法参加的计划、透露了用户打算保密的信息，或使用了伴侣觉得可疑或受伤的措辞
4. 伴侣认为这些消息是用户发送的
5. AI 生成的对话导致了现实世界的关系后果

这种场景不需要 AI 有任何恶意意图。AI 的回复与用户实际会说的话之间的简单偏差就足以造成伤害。

### 6.4 场景：通过扩展中继的会话劫持 (Session Hijacking)

**攻击链：**
1. Chrome 扩展中继将 AI 连接到用户的实时浏览器
2. AI 从 Gmail、银行网站和社交媒体读取认证 Cookie
3. AI 通过 JavaScript 执行提取会话令牌
4. 令牌可以通过 AI 有权访问的任何频道外泄
5. 或者，AI 直接使用实时会话来采取操作

扩展中继使这特别危险，因为它在用户的实际浏览器实例中操作 -- 而不是沙箱化的副本 -- 这意味着它可以访问用户看到的一切和用户已认证的每个服务。

### 6.5 场景：AI 读取邮件、决策、行动、回复

**攻击链 -- 完整循环：**
1. AI 在浏览器中打开 Gmail（通过 Chrome 配置文件已认证）
2. AI 读取来自用户医生的一封包含检查结果的邮件
3. AI 处理医疗信息
4. AI 收到来自用户配偶的短信："医生怎么说的？"
5. AI 通过 iMessage 用医疗结果的摘要回复
6. AI 还可能回复医生的邮件提出后续问题

在整个过程中，用户从未选择分享他们的医疗结果。配偶不知道他们收到的信息是经过 AI 过滤的。医生不知道 AI 在阅读和回复医疗通信。

---

## 7. 风险矩阵

### 7.1 频道冒充风险

| 风险 | 严重程度 | 可能性 | 影响 |
|--------------------------------|----------|------------|-----------|
| 不可检测的第三方 | 严重 (CRITICAL) | 启用自动回复 | 个人、法律、 |
| 欺骗 | | 时几乎必然 | 财务 |
| 以用户名义做出 | 高 (HIGH) | 高 | 财务、法律 |
| 未经授权的承诺 | | | |
| 因回复偏差导致 | 高 (HIGH) | 高 | 个人 |
| 关系受损 | | | |
| 违反平台服务条款 | 中 (MEDIUM) | 几乎必然 | 账户丧失 |
| 和账户终止 | | | |
| 语音通话冒充 | 严重 (CRITICAL) | 中 | 法律、财务 |
| 用于欺诈 | | | |
| 群聊中归属于用户 | 高 (HIGH) | 高 | 职业、 |
| 的错误信息 | | | 声誉 |
| 违反 AI 透明度 | 高 (HIGH) | 几乎必然 | 法律、监管 |
| 法规（欧盟 AI 法案等） | | | |

### 7.2 浏览器/计算机使用风险

| 风险 | 严重程度 | 可能性 | 影响 |
|--------------------------------|----------|------------|-----------|
| 未经授权的金融 | 严重 (CRITICAL) | 中 | 财务 |
| 交易 | | | |
| 会话令牌外泄 | 严重 (CRITICAL) | 中 | 完全账户 |
| | | | 接管 |
| 已保存密码暴露 | 严重 (CRITICAL) | 中 | 完全凭据 |
| | | | 泄露 |
| 在已认证页面上 | 严重 (CRITICAL) | 高 | 无限页面 |
| 执行任意 JavaScript | | | 操纵 |
| 窃取所有域的 Cookie | 严重 (CRITICAL) | 高 | 会话劫持 |
| 未经授权的表单提交 | 高 (HIGH) | 中 | 财务、法律 |
| （购买、设置变更） | | | |
| 下载文件到本地系统 | 高 (HIGH) | 中 | 数据外泄、 |
| | | | 恶意软件载体 |
| CDP 端口 9222 网络暴露 | 严重 (CRITICAL) | 中 | 完全远程 |
| | | | 浏览器控制 |
| 导航守卫绕过 | 高 (HIGH) | 高 | 不受限制的 |
| | | | URL 访问 |

### 7.3 组合能力风险

| 风险 | 严重程度 | 可能性 | 影响 |
|--------------------------------|----------|------------|-----------|
| 在浏览器中读取隐私数据， | 严重 (CRITICAL) | 高 | 隐私 |
| 通过消息频道泄露 | | | 灾难 |
| 冒充用户同时进行 | 严重 (CRITICAL) | 中 | 财务、 |
| 已认证的 Web 交易 | | | 法律 |
| 通过用户身份 + 浏览器 | 严重 (CRITICAL) | 中 | 间谍活动、 |
| 数据访问进行社会工程 | | | 数据窃取 |
| 完整的自主代理循环： | 严重 (CRITICAL) | 中 | 无界 |
| 读取、决策、行动、通信 | | | |
| 操作链中的任何环节 | 严重 (CRITICAL) | 几乎必然 | 以上 |
| 都没有人工介入 | | （设计如此） | 所有 |

---

## 8. 建议

### 8.1 冒充控制 -- 即时措施 (P0)

**R-IMP-01：强制 AI 披露**
AI 在每个平台上发送的每条消息都必须包含不可移除的 AI 生成标识。建议格式：
- 文本消息：每条消息添加 `[AI-Generated]` 前缀
- 语音通话：每次通话开始时必须进行语音披露
- 群聊：每条消息添加不可抑制的 `[AI]` 标签

**R-IMP-02：按联系人选择启用的自动回复**
自动回复不得默认为所有联系人启用。用户必须明确指定哪些联系人可以接收 AI 生成的回复。某些联系人类别应被永久排除：
- 紧急服务
- 医疗提供者
- 金融机构
- 法律代表
- 政府机构

**R-IMP-03：消息审查队列**
实施强制性审查队列，在发送之前用户批准或拒绝 AI 生成的回复。至少应适用于首次联系人、被标记为敏感的联系人以及任何包含财务承诺、法律语言或医疗信息的消息。

**R-IMP-04：语音通话限制**
语音通话功能应默认禁用，需要用户对每次通话进行明确授权。AI 绝不应能够自主发起语音通话。

### 8.2 冒充控制 -- 短期措施 (P1)

**R-IMP-05：对话审计日志**
维护所有 AI 生成消息的完整、防篡改日志，包括原始传入消息、AI 生成的回复、平台和接收者以及时间戳。用户必须能够审查 AI 以他们的名义说了什么。

**R-IMP-06：回复边界执行**
实施 AI 以用户名义可以说什么的硬性边界：
- 不能做出财务承诺
- 不能同意法律条款
- 不能分享医疗或健康信息
- 不能分享位置数据
- 不能分享凭据或验证码
- 不能表达浪漫或性兴趣（无论 Clawra 用例如何）

**R-IMP-07：特定平台合规**
实施特定平台的合规模块，确保消息满足每个平台对自动消息的服务条款要求。在平台提供官方 Bot API 的情况下，应使用 Bot API 而非用户会话冒充。

### 8.3 浏览器限制 -- 即时措施 (P0)

**R-BRW-01：域名分类和限制**
用一个全面的域名分类系统替换 2.4KB 的导航守卫。至少将域名分为：
- **阻止** -- 银行、金融服务、医疗门户、政府服务、电子邮件提供商、密码管理器和身份服务。AI 在没有每次会话明确用户授权的情况下绝不应能导航到这些域名。
- **只读** -- 社交媒体、新闻和一般网页。AI 可以查看内容但不能提交表单、点击操作按钮或修改状态。
- **完全访问** -- 仅为当前任务明确允许的域名。

**R-BRW-02：Cookie 和存储隔离**
AI 浏览器会话不得访问用户的真实 Cookie、localStorage 或 sessionStorage。使用没有预先存在认证状态的单独浏览器配置文件。如果需要访问已认证会话，实施具有会话范围时间限制的逐域用户授权。

**R-BRW-03：禁用已认证会话的 Chrome 扩展中继**
扩展中继不得将 AI 桥接到用户已认证敏感服务的会话中。至少在中继中实施域名级过滤，以防止访问金融、电子邮件和身份提供者域名。

**R-BRW-04：CDP 端口安全**
端口 9222 不得暴露给任何网络接口。如果需要 CDP，仅绑定到 localhost 并实施认证。沙箱 Dockerfile 必须更新以移除端口暴露或添加防火墙规则。

### 8.4 浏览器限制 -- 短期措施 (P1)

**R-BRW-05：JavaScript 执行限制**
为 JavaScript 执行实施策略引擎：
- 阻止对 `document.cookie` 的访问
- 阻止对 `localStorage` 和 `sessionStorage` 的访问
- 阻止用于跨源请求的 `XMLHttpRequest` 和 `fetch`
- 阻止对 `window.open` 的访问
- 记录所有 JavaScript 执行以供审计

**R-BRW-06：表单提交控制**
所有表单提交必须被拦截、分类，并被阻止或呈现给用户审批。至少对以下情况需要用户审批：
- 金融域名上的任何表单
- 包含密码字段的任何表单
- 具有支付方式字段的任何表单
- 触发向不同域名发出 POST 请求的任何表单

**R-BRW-07：下载限制**
实施文件下载控制：
- 将下载限制为当前任务所需的特定文件类型
- 阻止可执行文件下载（.exe、.msi、.dmg、.sh、.bat、.cmd）
- 超过大小阈值的下载需要用户审批
- 将下载的文件沙箱化到隔离目录中

**R-BRW-08：独立浏览器配置文件**
AI 必须在不包含以下内容的隔离浏览器配置文件中运行：
- 已保存密码
- 来自用户浏览的持久化 Cookie
- 浏览历史
- 书签
- 自动填充数据
如果 AI 需要访问特定的已认证服务，实施一种单点登录流程，仅授予对该特定服务的有时间限制和范围限制的访问权限。

### 8.5 组合能力控制 (P0)

**R-CMB-01：操作关联监控**
实施监控以检测 AI 何时将频道冒充与浏览器操作相结合 -- 例如，当 AI 从浏览器读取数据然后通过消息频道泄露时。这些组合操作应需要明确的用户授权。

**R-CMB-02：信息流控制 (Information Flow Controls)**
从浏览器读取的数据不得在未经用户审查的情况下流向消息频道。实施跟踪数据来源的信息流标签，并阻止跨边界流动：
- 浏览器来源数据未经批准不能通过消息发送
- 消息接收的数据未经批准不能用于驱动浏览器操作
- 来自任何来源的财务数据未经批准不能通过任何频道传输

**R-CMB-03：敏感链的人工介入 (Human-in-the-Loop for Sensitive Chains)**
任何涉及读取隐私数据和对外通信的操作链都必须有一个强制性的人工介入检查点。AI 必须向用户展示其计划做什么的摘要 -- 它读取了什么数据、它计划说什么、对谁说、通过哪个频道 -- 并在继续之前获得明确批准。

---

## 9. 发现总结

OpenClaw 的频道冒充和浏览器控制的结合创造了一个 AI 代理，它可以：

1. **读取** 用户在浏览器中能看到的任何内容
2. **决策** 基于该信息做什么
3. **行动** 在用户已认证的任何网站上
4. **通信** 将结果发送给用户联系人列表中的任何人
5. **在每一步都以用户身份** 完成以上所有操作

没有其他面向消费者的软件在如此少的限制下提供这种能力组合。导航守卫是极简的。披露机制是缺失的。AI 与用户在线身份之间的认证边界实际上不存在。

本文档中的建议不是增强功能 -- 而是负责任部署的先决条件。如果没有强制性的 AI 披露、域名级浏览器限制、Cookie 隔离以及敏感操作链的人工介入控制，OpenClaw 对用户隐私、财务安全、人际关系和法律地位构成了不可接受的风险。

---

*OpenClaw 安全研究 -- 第六阶段（频道冒充）与第七阶段（浏览器/计算机使用）*
*分析系列的第 10 份文档*
