> 本文为中文翻译版本。英文原版为权威版本，如有差异以英文版为准。
> [English Version](../14-final-report.md)

# 第十阶段：最终综合报告

## OpenClaw 安全与伦理研究 — 完整发现

**研究期间**：2026年2月
**研究人员**：Tim Wu + Claude (Anthropic)
**研究对象**：OpenClaw v0.x（开源AI个人助理，237K GitHub星标）
**研究方法**：通过GitHub API进行静态源代码分析；无代码执行或渗透测试

---

## 1. 执行摘要

### 单段结论

OpenClaw是一个技术上令人印象深刻的开源项目，在安全基础设施方面进行了有意义的投入——比大多数可比的AI助理项目做得更多。然而，其基础架构授予AI代理对人类设备、通信、凭证和个人数据的持久性、始终在线的访问权限，同时依赖配置正确性、用户警觉性和LLM行为合规性作为其主要安全屏障。结果是一个系统，其中"个人助理"和"完全设备入侵"之间的距离不是通过架构保障措施来衡量，而是通过配置标志、提示合规性，以及假设未经审查的npm市场中的插件永远不会变得恶意来衡量。在检查安全性、供应链、内存、自治性、冒充、浏览器控制和伦理的八个分析阶段中，本研究发现了一个一致的模式：能力的部署远远领先于使其安全所需的控制。该项目迫切需要在能力和控制之间实现架构隔离，对高影响操作实施强制性的人机回路，以及一个不假设系统中每个组件都怀有善意的信任模型。

### 三大最关键发现

**1. 插件系统 = 无限制代码执行（第3阶段）**
所有48+个捆绑插件和从ClawHub安装的任何社区插件都在宿主应用程序进程内运行。插件SDK提供shell执行、文件系统访问、网络能力，以及AI生命周期每个阶段的钩子。没有沙箱、没有权限模型、没有代码签名，也没有有意义的审查流程。单个恶意插件即可实现完全系统入侵。

**2. 没有紧急停止开关的自主运行（第5阶段）**
该系统包含约510KB的代码支持自主运行：cron调度、所有消息通道的自动回复、webhook钩子和自生成代理链。没有全局紧急停止。代理链是无界的。系统可以在24/7没有人类在场的情况下采取行动，用户对系统自主做什么的认知与它在架构上能做什么之间存在巨大差距。

**3. 冒充作为一项功能（第6-7阶段）**
AI通过WhatsApp、Telegram、电子邮件和其他渠道以用户身份发送消息，无需向收件人强制披露。结合可以访问cookies、保存的密码和已认证会话的浏览器自动化，以及支持语音冒充的语音通话功能，这创建了一个可以令人信服地作为用户行事的系统，收件人无法将其与真实的人类通信区分开来。

### 总体风险评级

```
+================================================================+
|                                                                |
|              总体风险评级：严重                                   |
|                                                                |
|  系统的能力-控制比率危险地倾斜。在其当前架构中的生产部署           |
|  使用户面临大多数人不会故意接受的风险。                           |
|                                                                |
+================================================================+
```

---

## 2. 综合风险仪表板

### 2.1 风险摘要表

| # | 风险类别 | 阶段 | 严重性 | 可能性 | 风险评分 | 状态 |
|---|---|---|---|---|---|---|
| R1 | 插件进程内执行 | 3 | 严重 | 高 | 25/25 | 无缓解措施 |
| R2 | 无全局紧急停止 | 5 | 严重 | 高 | 25/25 | 无缓解措施 |
| R3 | 未沙箱化的代理链 | 5 | 严重 | 高 | 25/25 | 无缓解措施 |
| R4 | 无披露的用户冒充 | 6 | 严重 | 高 | 24/25 | 无缓解措施 |
| R5 | 沙箱网络未隔离 | 2 | 严重 | 中 | 20/25 | 部分 |
| R6 | 浏览器访问认证会话 | 7 | 严重 | 中 | 20/25 | 最小防护 |
| R7 | 内存未加密发送到外部API | 4 | 高 | 高 | 20/25 | 无缓解措施 |
| R8 | 通过LLM合规性的提示注入 | 2 | 高 | 高 | 20/25 | 仅理想化 |
| R9 | ClawHub无审查流程 | 3 | 高 | 中 | 16/25 | 无缓解措施 |
| R10 | 配置标志禁用所有安全 | 2 | 高 | 中 | 16/25 | 按设计 |
| R11 | 正则表达式安全扫描器容易绕过 | 3 | 高 | 中 | 16/25 | 部分 |
| R12 | skill-creator启用自复制插件 | 3 | 高 | 低 | 12/25 | 无缓解措施 |
| R13 | Gmail钩子 = 提示注入向量 | 5 | 高 | 中 | 16/25 | 无缓解措施 |
| R14 | 预授权执行批准模式 | 5 | 高 | 中 | 16/25 | 按设计 |
| R15 | 内存投毒攻击 | 4 | 高 | 中 | 16/25 | 无缓解措施 |
| R16 | 内存无静态加密 | 4 | 中 | 高 | 15/25 | 无缓解措施 |
| R17 | 无被遗忘权（嵌入） | 4 | 中 | 高 | 15/25 | 架构上困难 |
| R18 | 未经同意收集第三方数据 | 4,8 | 中 | 高 | 15/25 | 无缓解措施 |
| R19 | 网关仅令牌认证，无MFA | 2 | 中 | 中 | 12/25 | 部分 |
| R20 | 工具拒绝列表是退出而非加入 | 2 | 中 | 中 | 12/25 | 按设计 |
| R21 | 语音冒充能力 | 6 | 中 | 低 | 9/25 | 无缓解措施 |
| R22 | 依赖性和习得性无助 | 8 | 中 | 高 | 15/25 | 未解决 |
| R23 | 随时间推移的能动性侵蚀 | 8 | 中 | 高 | 15/25 | 未解决 |
| R24 | Chrome扩展桥接到真实会话 | 7 | 高 | 低 | 12/25 | 按设计 |
| R25 | 浏览器沙箱中暴露CDP端口9222 | 2 | 中 | 中 | 12/25 | 按设计 |

### 2.2 风险热图

```
可能性 ->   低          中        高
                (1-2)        (3)           (4-5)
严重性
   |
   v

严重    [R12        ] [R5,R6      ] [R1,R2,R3,R4]
(5)         [            ] [            ] [            ]

高        [R24         ] [R9,R10,R11 ] [R7,R8       ]
(4)         [            ] [R13,R14,R15] [            ]

中      [R21         ] [R19,R20,R25] [R16,R17,R18 ]
(3)         [            ] [            ] [R22,R23     ]

低         [            ] [            ] [            ]
(2)         [            ] [            ] [            ]

信息        [            ] [            ] [            ]
(1)         [            ] [            ] [            ]

关键：右上象限 = 补救的最高优先级
     严重/高4个风险 = 需要立即采取行动
```

### 2.3 按阶段的风险分布

```
第2阶段（安全/沙箱）：    ||||||||  6个风险
第3阶段（插件供应链）： ||||      4个风险
第4阶段（内存/数据）：         |||||     5个风险
第5阶段（自治性/同意）：    |||||     5个风险
第6-7阶段（冒充/浏览器）： |||| 4个风险
第8阶段（伦理）：               ||      2个风险（系统性，难以计数）
                                ----
                          总计：识别出25+个离散风险
```

---

## 3. 风险架构

### 3.1 所有风险向量如何交互

以下图表显示OpenClaw的风险并非独立。它们形成一个连接的攻击图，任何单个向量的入侵都可以在系统中级联。

```
                        +-------------------+
                        |   外部输入  |
                        | (消息、邮件,|
                        |  webhooks、cron)  |
                        +--------+----------+
                                 |
                    +------------+------------+
                    |                         |
            +-------v-------+        +-------v--------+
            | 自动回复    |        | 插件钩子   |
            | (处理    |        | (8个生命周期   |
            |  所有消息)|        |  拦截  |
            +-------+-------+        |  点)       |
                    |                +-------+--------+
                    |                        |
                    +----------+-------------+
                               |
                       +-------v--------+
                       |  代理核心    |
                       |  (LLM驱动   |
                       |   决策     |<-------- 提示注入
                       |   制定)      |          (LLM合规性
                       +---+---+---+----+           是唯一防御)
                           |   |   |
              +------------+   |   +-------------+
              |                |                 |
      +-------v------+ +------v-------+ +-------v--------+
      | 通信| | 浏览器/     | | 文件系统/   |
      | 通道     | | 计算机使用 | | 代码执行      |
      | - WhatsApp   | | - CDP 9222   | | - Shell访问 |
      | - Telegram   | | - Playwright | | - 插件SDK   |
      | - 邮件      | | - JS eval    | | - npm安装  |
      | - 语音      | | - Cookies    | | - 进程内   |
      +-------+------+ | - 密码  | +-------+--------+
              |         +------+-------+         |
              |                |                 |
      +-------v------+ +------v-------+ +-------v--------+
      | 冒充| | 会话      | | 系统         |
      | - 以    | | 劫持    | | 入侵     |
      |   用户身份发送       | | - 认证令牌| | - 完整设备  |
      | - 无         | | - 保存的      | |   访问       |
      |   披露 | |   会话   | | - 数据泄露   |
      +--------------+ +--------------+ +----------------+
              |                |                 |
              +----------+----+-----------------+
                         |
                 +-------v--------+
                 |   内存       |
                 |   系统       |
                 | - 跨会话持久     |
                 |   化       |        +------------------+
                 | - 未加密  |        | 外部API    |
                 | - 可投毒   |        | (OpenAI, Google, |
                 +----------------+        |  Voyage, Mistral)|
```

### 3.2 瑞士奶酪模型 — 所有孔洞对齐之处

在安全工程中，"瑞士奶酪模型"展示了当多个防御层中的孔洞对齐时事故如何发生。OpenClaw有防御层，但孔洞在几个关键路径上对齐。

```
防御层：          每层中的孔洞：

第1层：认证/网关      [  仅令牌，无MFA，局域网绑定        ]
           |                        |
           v                        v
第2层：沙箱            [  无网络隔离，CDP暴露    ]
           |                        |
           v                        v
第3层：提示防御     [  仅LLM合规性，无结构化   ]
           |                        |
           v                        v
第4层：插件扫描    [  仅正则表达式，跳过node_modules       ]
           |                        |
           v                        v
第5层：权限模型   [  无 — 插件进程内运行        ]
           |                        |
           v                        v
第6层：人工批准     [  可预授权，可通过cron绕过   ]
           |                        |
           v                        v
第7层：审计/监控   [  无插件运行时监控     ]

关键路径示例（所有孔洞对齐）：
恶意ClawHub插件通过正则扫描 -> 进程内加载 ->
钩住before-agent-start -> 修改代理行为 -> 访问
浏览器会话 -> 通过网络泄露cookies（无沙箱
网络隔离）-> 通过内存系统持久化 -> 重启后存活。

每个防御层都有一个孔洞，而一个坚定的攻击者可以
穿过所有这些孔洞。
```

---

## 4. 十大关键发现

### 发现#1：插件以完全系统权限执行

**严重性 x 可能性：25/25（严重）**

**描述**：所有插件，无论是捆绑的还是社区安装的，都在与宿主应用程序相同的Node.js进程中运行。插件SDK提供`run-command.ts`（shell执行）、`json-store.ts`（文件系统）、`fetch-auth.ts`（带凭证的网络），以及8个拦截每个AI操作的生命周期钩子。

**证据**：插件加载器（`loader.ts`，22KB）直接导入并执行插件代码。没有`vm`模块隔离，没有Worker线程，没有子进程沙箱。`hooks.ts`（23KB）系统允许插件注册`before-agent-start`、`after-agent-end`和其他6个生命周期事件。

**影响**：单个恶意或被入侵的插件实现完全系统入侵：访问所有用户数据、以用户身份发送消息的能力、访问所有API密钥和凭证、安装更多恶意插件的能力。

**当前缓解措施**：`skill-scanner.ts`执行基于正则表达式的静态分析。跳过`node_modules`。上限为500个文件。无法检测混淆、动态代码生成或依赖链攻击。

**差距**：没有沙箱、没有权限模型、没有代码签名、没有运行时监控、没有行为分析。扫描器是一个减速带，而非安全边界。

---

### 发现#2：无全局紧急停止

**严重性 x 可能性：25/25（严重）**

**描述**：OpenClaw有多个自主运行系统（cron、自动回复、钩子、生成的会话），但没有单一机制可以同时停止所有这些系统。

**证据**：Cron系统（约230KB）、自动回复系统（约280KB+）、钩子系统和会话生成都独立运行。禁用一个不会影响其他的。没有`STOP_ALL`命令，没有紧急按钮，没有死人开关。

**影响**：如果系统进入有害的自主循环（代理生成代理，cron触发钩子触发代理），用户无法采取单一行动来停止所有活动。他们必须独立识别和禁用每个子系统，在此期间系统继续运行。

**当前缓解措施**：单独的通道禁用切换。进程级kill（`kill -9`）。Docker容器停止。

**差距**：应用内无紧急停止。没有心跳监控。没有断路器。没有异常行为的自动停止。

---

### 发现#3：无界代理链

**严重性 x 可能性：25/25（严重）**

**描述**：会话可以生成其他会话，cron作业可以触发钩子，钩子可以调用代理，代理可以安排新的cron作业。开发人员在内部文档中将这种模式称为"RCE"（远程代码执行）。

**证据**：`session-spawning.ts`创建新的代理实例。没有深度限制。没有广度限制。没有总资源上限。Cron -> 钩子 -> 代理 -> 会话 -> cron创建一个没有终止保证的循环。

**影响**：资源耗尽（CPU、内存、API额度）。不受控制的自主操作级联。以人类无法监控的速度和量采取行动。

**当前缓解措施**：在代码分析中未发现。

**差距**：没有递归深度限制。没有总生成计数限制。没有资源预算。没有链深度的自动断路器。

---

### 发现#4：无披露的用户冒充

**严重性 x 可能性：24/25（严重）**

**描述**：AI通过WhatsApp、Telegram、电子邮件和其他通道以用户身份发送消息，无需向收件人强制披露AI生成了内容。结合语音通话功能，这实现了全方位冒充。

**证据**：通道集成代码通过已认证的用户会话发送消息。没有`[AI生成]`前缀。电子邮件中没有披露标题。没有通知收件人。

**影响**：收件人认为他们正在与人类交流。信任违规。法律责任（冒充法、欺诈法规）。关系损害。在某些司法管辖区，根据消费者保护或AI披露法律是非法的。

**当前缓解措施**：未发现。披露不可配置；它根本不存在。

**差距**：根本没有披露机制。甚至没有可选的。

---

### 发现#5：沙箱容器缺乏网络隔离

**严重性 x 可能性：20/25（严重）**

**描述**：用于代码执行和浏览器自动化的Docker沙箱容器不强制执行网络隔离。沙箱可以进行任意出站网络请求。

**证据**：Dockerfile分析显示没有`--network=none`标志。沙箱包含`curl`作为捆绑工具。浏览器沙箱在端口9222上暴露CDP，在5900上暴露VNC，在6080上暴露noVNC。

**影响**：沙箱代码可以向外部服务器泄露数据。浏览器沙箱可以通过CDP远程控制。沙箱逃逸有网络路径可以利用。

**当前缓解措施**：容器内的非root用户。进程级限制。

**差距**：没有网络命名空间隔离。没有出口过滤。没有流量监控。

---

### 发现#6：浏览器访问已认证会话

**严重性 x 可能性：20/25（严重）**

**描述**：浏览器自动化系统可以访问cookies、localStorage，填写表单，评估任意JavaScript，并且通过Chrome扩展中继桥接到用户的真实浏览器会话，其中保存有密码和已认证状态。

**证据**：浏览器功能包括Playwright自动化、CDP直接访问、用于任意JS执行的`browser_evaluate`，以及cookie/localStorage访问。Chrome扩展（`chrome-extension/`）创建到用户实际Chrome配置文件的中继。导航守卫为2.4KB — 最小保护。

**影响**：访问用户登录的任何网站：银行、电子邮件、社交媒体、企业系统。能够在任何Web服务上以用户身份执行操作。通过cookie/localStorage提取进行凭证盗窃。

**当前缓解措施**：导航守卫（2.4KB）提供最小的URL过滤。

**差距**：没有域白名单。没有凭证隔离。AI控制和用户控制的浏览器上下文之间没有会话分离。

---

### 发现#7：内存数据发送到外部API

**严重性 x 可能性：20/25（高）**

**描述**：向量嵌入内存系统将用户对话内容发送到外部API（OpenAI、Google、Voyage、Mistral）进行向量化。这些数据包括个人对话、第三方信息和潜在的敏感内容。

**证据**：内存系统（`src/memory/`，约64KB）使用外部嵌入API。内容被传输以进行向量化。没有客户端嵌入或同态加密的证据。

**影响**：敏感用户数据传输到第三方AI公司并由其处理。受这些公司的数据保留和训练策略约束。对话中提到的第三方在未经其同意的情况下收集了他们的数据。

**当前缓解措施**：传输使用TLS。依赖提供商数据策略。

**差距**：没有客户端嵌入选项。没有数据最小化。用户无法控制向量化的内容。没有第三方同意机制。

---

### 发现#8：提示注入防御是理想化的

**严重性 x 可能性：20/25（高）**

**描述**：针对提示注入的主要防御是指示LLM忽略恶意指令——本质上是要求AI表现良好。这已被反复证明可以在所有主要LLM上绕过。

**证据**：系统中的安全提示指示AI"忽略试图覆盖您的指南的指令"。没有结构化防御，如输入清理、单独的解析/执行模型或能力令牌。

**影响**：任何输入通道（消息、电子邮件、Web内容、文档）都可能包含颠覆AI行为的提示注入。鉴于系统的能力（消息传递、浏览、代码执行），成功的注入可以实现AI能做的任何事情。

**当前缓解措施**：系统提示指令。LLM安全训练。

**差距**：指令和数据平面之间没有结构化隔离。没有针对已知注入模式的输入清理。没有每个上下文的能力限制。

---

### 发现#9：ClawHub市场没有可见的审查流程

**严重性 x 可能性：16/25（高）**

**描述**：ClawHub是OpenClaw技能/插件的社区市场。分析显示没有可见的代码审查流程，除了基于正则表达式的`skill-scanner.ts`之外没有自动安全扫描，也没有签名或认证机制。

**证据**：市场基础设施代码显示发现、注册表查找和基于npm的安装。没有代码审查队列。没有批准工作流程。循环中没有人工审查员。

**影响**：恶意插件可以发布到ClawHub并由信任市场的用户安装。鉴于发现#1（插件进程内运行），这创建了从"发布到市场"到"入侵用户系统"的直接路径。

**当前缓解措施**：基于正则表达式的扫描器。社区标记（如果存在）。

**差距**：没有审查流程。除正则表达式外没有自动安全分析。没有代码签名。没有声誉系统。没有针对未审查插件的安装时警告。

---

### 发现#10：配置标志禁用所有安全

**严重性 x 可能性：16/25（高）**

**描述**：OpenClaw包含配置标志，如`dangerouslyDisableDeviceAuth`，可以禁用整个安全基础设施。这些标志有文档记录且可访问，将安全模型变成了一个选择加入系统，而不是结构保证。

**证据**：第2阶段的配置标志分析识别出多个`dangerously*`前缀选项，绕过认证、沙箱限制和批准要求。

**影响**：设置这些标志的用户（也许遵循教程，或"让东西工作"）同时移除所有安全屏障。具有配置写入访问权限的插件可以以编程方式设置这些标志。

**当前缓解措施**：`dangerously*`命名约定作为警告。

**差距**：没有机制防止编程禁用。没有监控安全配置更改。没有针对危险标志组合的"您确定吗"确认。命名约定是唯一的保障。

---

## 5. 攻击面摘要

### 5.1 完整入口点枚举

```
入口点                  已防御？    防御质量
-----------                  ---------    ---------------
网关HTTP API（18789）     部分      令牌认证，无MFA，局域网绑定
网关WebSocket（18790）    部分      与HTTP相同
入站消息（所有        否           AI自动处理；提示
  通道：WhatsApp，                     注入是主要风险
  Telegram、SMS等）
入站电子邮件（Gmail钩子）   否           AI处理所有匹配的电子邮件
入站webhooks             否           钩子在没有验证的情况下触发
Cron触发的代理        否           在没有人类在场的情况下执行
插件安装（npm）    最小      仅正则扫描器
插件运行时（钩子）       否           进程内，完全权限
浏览器CDP（端口9222）      否           暴露，无认证
浏览器VNC（端口5900）      否           在沙箱上暴露
浏览器noVNC（端口6080）    否           Web可访问
Chrome扩展中继       否           桥接到真实浏览器
内存系统查询        最小      SQLite，无静态加密
配置文件（设置）       否           可写，控制安全
沙箱逃逸（容器）   部分      非root用户，但网络开放
工具调用（AI）         部分      拒绝列表（退出，而非加入）
文件系统（工作空间）      部分      卷挂载，范围各异
会话生成             否           无界，无限制
```

### 5.2 摘要统计

```
识别的总入口点：    19
未防御或最小防御： 14（74%）
部分防御：                5（26%）
完全防御：                    0（0%）
```

系统中没有一个入口点具有被认为是完整防御的东西。即使是最受保护的入口点（网关）也缺少MFA并默认绑定到局域网。

---

## 6. OpenClaw 做得好的地方

如果不承认OpenClaw做对的地方，这项研究将是不完整的——而且是不诚实的。该项目进行了真正的安全投入，超过了开源AI助理项目的常规。

### 6.1 真正的安全投入

**大量安全代码库**：`src/security/`目录包含约300KB的代码加约150KB的测试。这不是象征性的努力。有人在安全方面投入了大量的工程时间。

**固定的Docker基础镜像**：沙箱Dockerfiles通过SHA摘要固定基础镜像，而不仅仅是标签。这可以防止通过标签变异的供应链攻击——许多项目忽视的最佳实践。

**非root容器用户**：沙箱以非root的`sandbox`用户身份运行，限制了容器逃逸的爆炸半径。

**`dangerously*`命名约定**：安全关键的配置标志以`dangerously`为前缀，创建了一个心理屏障（虽然不是技术屏障）来防止随意禁用。

**执行批准系统**：系统确实有一种机制，可以在执行命令之前进行人工批准。虽然可以预授权，但该机制存在并在正确配置时有效。

**全面的测试覆盖**：安全测试（约150KB）表明安全功能经过测试，而不仅仅是实现。

**开源透明度**：整个代码库是公开的，使得像本研究代表的这种分析成为可能。这是一个有意义的安全姿态决定——通过透明度而不是隐蔽性来实现安全。

### 6.2 与其他开源AI项目的比较

| 功能 | OpenClaw | 典型的OS AI助理 |
|---|---|---|
| 安全代码库 | 约300KB + 测试 | 通常<10KB或无 |
| 容器沙箱 | 是（3个镜像） | 罕见 |
| 基础镜像固定 | SHA摘要 | 仅标签或未固定 |
| 安全扫描器 | 是（基于正则表达式） | 几乎从不 |
| 认证系统 | 基于令牌的网关 | 通常无 |
| 执行批准 | 基于模式的系统 | 通常缺失 |
| 安全测试 | 约150KB | 罕见 |

按照开源AI助理的标准，OpenClaw是更具安全意识的项目之一。问题不在于开发人员粗心——而在于这个问题极其困难，而"比大多数好"仍然远远不足以应对具有这种能力级别的系统。

---

## 7. OpenClaw 做错的地方

### 7.1 基本架构问题

**能力先于控制**：系统首先部署能力（消息传递、浏览、代码执行、自主运行），其次添加控制（扫描、批准、监控）——如果有的话。安全架构应该是相反的：首先建立控制边界，然后在其中授予能力。

**默认信任**：架构假设到处都是信任。插件受信任。消息受信任。嵌入受信任。配置受信任。唯一不完全信任的实体是用户（必须向网关进行身份验证）。在安全架构中，默认情况下没有任何东西是受信任的。

**进程内一切**：在单个进程中运行插件、钩子、工具和AI代理意味着任何组件的入侵都会危及所有组件。进程隔离，计算中最基本的安全边界，是缺失的。

**没有深度的纵深防御**：安全层存在，但每层都很薄且多孔。没有MFA的令牌认证。没有网络隔离的沙箱。没有分析深度的扫描。没有范围限制的批准。没有执行的命名约定。每一层都提供一些阻力；没有一层提供硬停止。

### 7.2 安全戏剧 vs. 真正的安全

OpenClaw中的几个安全功能，虽然出于善意，但提供了安全的外观而没有实质内容。

**正则表达式安全扫描器**：`skill-scanner.ts`使用正则表达式扫描JavaScript和TypeScript文件中的可疑模式。它跳过`node_modules`（npm包中大多数恶意代码所在的地方）。它上限为500个文件。它无法检测混淆、动态`eval`、原型污染或依赖链攻击。发布这个扫描器可能会产生错误的信心，认为插件已经过"安全检查"。

**基于提示的注入防御**：要求LLM忽略恶意指令是AI安全中的等价物，相当于要求锁不被撬。LLM越狱是一个有充分文档记录的领域，有数百种已知的绕过技术。这种防御有价值（它阻止随意尝试），但称其为安全控制夸大了其有效性。

**拒绝列表模型**：工具默认允许，只有在明确拒绝时才被阻止。这意味着每个新工具、每个新插件能力和每个新API都自动可供AI使用。安全模型是相反的：默认拒绝，明确允许。拒绝列表随攻击面线性增长；允许列表仅随有意授权增长。

**具有网络访问权限的容器"沙箱"**：无法阻止出站网络流量的容器在任何有意义的安全意义上都不是沙箱。它隔离文件系统和一些系统调用，但恶意代码最危险的能力——与攻击者的服务器通信——是不受限制的。

---

## 8. 综合建议

### 第1层：严重 — 在任何生产使用之前必须修复

这些问题代表立即的、可利用的漏洞，应该阻止任何生产部署的建议。

| # | 建议 | 解决 | 工作量 |
|---|---|---|---|
| T1.1 | **实施插件沙箱**：在单独的进程或V8隔离中运行插件，并明确授予能力。任何插件都不应具有完全系统访问权限。 | R1, R9, R11, R12 | 大 |
| T1.2 | **添加全局紧急停止**：单个命令/按钮立即停止所有自主操作——cron、自动回复、钩子、生成的会话，一切。 | R2, R3 | 中 |
| T1.3 | **在沙箱中强制执行网络隔离**：对沙箱容器应用`--network=none`或等效项。仅为明确允许的域提供代理。 | R5, R6 | 小 |
| T1.4 | **添加强制性AI披露**：AI发送的所有消息必须包含机器可读和人类可见的指示符，表明内容是AI生成的。 | R4, R21 | 小 |
| T1.5 | **实施代理链限制**：对会话生成深度、总活动生成和生成速率的硬上限。异常链增长的断路器。 | R3 | 小 |
| T1.6 | **删除或限制`dangerously*`标志**：使禁用安全的标志需要多步骤确认，防止编程设置，并记录所有更改。 | R10 | 小 |

### 第2层：高 — 3个月内修复

| # | 建议 | 解决 | 工作量 |
|---|---|---|---|
| T2.1 | **插件权限模型**：在清单中声明所需的能力。用户在安装时批准。通过沙箱进行运行时强制执行。 | R1, R9 | 大 |
| T2.2 | **为工具实施白名单**：反转拒绝列表模型。除非明确允许当前上下文，否则工具不可供AI使用。 | R20, R8 | 中 |
| T2.3 | **为网关认证添加MFA**：令牌+第二因素。默认情况下不绑定到局域网。 | R19 | 中 |
| T2.4 | **内存静态加密**：加密SQLite数据库。提供密钥管理。 | R16 | 中 |
| T2.5 | **浏览器域白名单**：AI浏览器访问仅限于明确批准的域。默认情况下无法访问银行、电子邮件或管理UI。 | R6, R24 | 中 |
| T2.6 | **结构化提示注入防御**：分离指令和数据通道。输入清理。每个上下文的能力令牌。 | R8, R13 | 大 |
| T2.7 | **插件代码签名**：要求插件上的加密签名。在安装和加载时验证。 | R1, R9 | 中 |

### 第3层：中等 — 6个月内修复

| # | 建议 | 解决 | 工作量 |
|---|---|---|---|
| T3.1 | **ClawHub审查流程**：自动安全分析（超越正则表达式）+市场插件的人工审查。 | R9, R11 | 大 |
| T3.2 | **客户端嵌入选项**：允许内存向量化而不向外部API发送数据。 | R7, R18 | 大 |
| T3.3 | **同意粒度**：每个通道、每个联系人、每个操作类型的同意。不仅仅是"启用自动回复=同意一切"。 | R4, R18, R22 | 中 |
| T3.4 | **运行时插件监控**：插件活动的行为分析。异常检测。警报意外的网络、文件系统或API访问。 | R1, R12 | 大 |
| T3.5 | **审计日志记录**：所有自主操作、插件活动和安全相关事件的全面、防篡改日志。 | R2, R3, R14 | 中 |
| T3.6 | **内存的数据最小化**：允许用户从内存中排除数据类别。实施保留限制。 | R15, R17, R18 | 中 |

### 第4层：长期 — 需要架构更改

| # | 建议 | 解决 | 工作量 |
|---|---|---|---|
| T4.1 | **微服务插件架构**：从进程内移至具有API边界的基于服务的插件执行。 | R1, R11, R12 | 非常大 |
| T4.2 | **安全属性的形式验证**：证明某些不变量成立（例如，"没有人工批准就不能发送消息"不能被任何代码路径违反）。 | R2, R4, R14 | 非常大 |
| T4.3 | **内存的差分隐私**：为向量嵌入系统实施形式化隐私保证。解决被遗忘权问题。 | R15, R17 | 非常大 |
| T4.4 | **保持能动性的设计**：重新设计交互模式，以维护和加强人类决策能力，而不是取代它。 | R22, R23 | 大 |
| T4.5 | **联合信任模型**：建立一个信任框架，其中不同的组件具有不同的权限级别，由架构边界强制执行，而不是配置。 | 全部 | 非常大 |

---

## 9. 对AI助理类别的影响

### 9.1 本研究揭示了关于所有AI个人助理的什么

OpenClaw不是独一无二的。它是代表性的。本研究中识别的风险在不同程度上存在于每个可以访问用户设备、通信和凭证的AI个人助理中。具体的实现细节不同，但基本的紧张关系是普遍的：

**能力悖论**：用户希望AI助理能够为他们做事（发送消息、管理日程、浏览网络、控制设备）。授予使助理有用的每个能力同时也是可以被利用、滥用或错误激活的能力。没有一种能力是纯粹有益的而没有风险面。

**自治性困境**：用户希望AI主动行动（提醒、自动回复、例行任务）。但是没有人工确认的主动行动在架构上与未经授权的行动无法区分。"有用的主动性"和"不需要的自主行为"之间的界限是一个判断，它因用户、上下文和时刻而异。

**冒充问题**：代表您进行交流的AI必须听起来像您才能有用。听起来像您的AI，按定义，正在冒充您。"有用的委托"和"身份欺诈"之间没有技术区别——差异仅在于相关方的同意。

**内存悖论**：记住您的偏好、历史和上下文的AI更有用。记住一切的AI创建了您生活的不可磨灭的记录，无法完全删除（嵌入是单向函数），可以被投毒，并且被传输到第三方进行处理。

### 9.2 治理差距

本研究揭示了一个深刻的治理差距。OpenClaw存在于一个监管真空中，其中：

- **没有标准定义"安全AI助理"。** 没有广泛采用的基准、认证或控制人类设备和通信的AI系统的最低安全要求。

- **责任未定义。** 当AI助理以用户身份发送有害消息、进行未经授权的购买或泄露敏感信息时，责任链（开发人员->部署者->用户->AI提供商）在大多数司法管辖区在法律上未经测试。

- **开源使问责变得复杂。** OpenClaw是社区开发和自托管的。没有供应商可以追究责任，没有SLA可以执行，出问题时没有支持热线可以拨打。

- **现有框架不适合。** GDPR、CCPA和其他隐私法规不是为AI系统设计的，这些系统将个人数据向量化为不可逆的嵌入并将它们发送到第三方API进行处理。"被遗忘权"与向量嵌入的数学相冲突。

### 9.3 监管者应考虑什么

基于本研究的发现，解决AI个人助理的监管者应考虑：

1. **通信中的强制性AI披露。** 任何由AI生成或显著修改并发送给人类的消息必须可识别为这样。这应该是法律要求，而不是可选功能。

2. **AI设备访问的最低安全标准。** 访问用户设备、浏览器、凭证或通信的AI系统应满足基线安全要求，包括：沙箱执行、静态加密数据、代码执行的网络隔离，以及对高影响操作的强制性人工批准。

3. **插件/扩展安全要求。** AI助理市场应具有法律规定的安全审查流程，类似于应用商店审查要求，但适应AI集成代码的更高风险环境。

4. **紧急停止要求。** 任何自主AI系统必须提供一个单一操作机制，以立即停止所有自主行为。这是工业紧急停止按钮的AI等价物。

5. **第三方的同意框架。** 当AI处理未同意AI交互的个人的数据时（消息收件人、对话中提到的人），必须有一个法律框架定义这些方的权利和保护。

6. **责任框架。** 明确分配AI助理行为的责任，特别是在冒充、数据泄露、未经授权的交易和造成伤害的自主行动的情况下。

---

## 10. 结论

### 10.1 基本紧张关系：能力 vs. 安全

OpenClaw体现了AI个人助理的核心紧张关系：使系统有用的每个功能同时使其变得危险。发送消息的能力是冒充的能力。浏览的能力是窃取凭证的能力。记住的能力是监视的能力。自主行动的能力是未经同意行动的能力。

这不是OpenClaw特有的设计缺陷。这是问题空间的基本属性。任何具有有意义能力的AI助理都将表现出这种紧张关系。问题不在于紧张关系是否存在，而在于如何管理它。

OpenClaw的答案，正如本研究所揭示的，是广泛部署能力并依赖配置、用户意识和LLM行为合规性来管理风险。这是不够的。当失败的后果是完全设备入侵、身份冒充或不受控制的自主行动时，防御必须是结构化的，而不是理想化的。

### 10.2 负责任的AI协助看起来像什么

基于本研究中识别的差距，负责任的AI协助应具有以下特征：

**默认最小权限**：除非明确授予，否则AI、插件或自主系统无法使用任何能力。系统从锁定状态开始，并通过有意、知情的用户同意开放。

**结构化安全，而非行为安全**：安全保证由架构强制执行（进程隔离、网络边界、能力令牌），而不是要求AI表现良好。即使LLM完全受损，系统也应该是安全的。

**透明操作**：AI采取的每个操作都被记录、可审计和可归因。AI生成的通信的收件人被告知。用户对自主操作具有实时可见性。

**人类主权**：人类始终保持有意义的控制。总有办法停止、审查和覆盖。系统加强人类能动性而不是取代它。便利不以自治为代价。

**可逆性**：操作可以撤消。数据可以删除。权限可以撤销。系统不会在没有明确人工批准的情况下创建不可逆的承诺。

**比例信任**：授予每个组件的信任级别与应用的验证级别成比例。未经审查的社区插件不会获得与核心功能相同的权限。

### 10.3 行动呼吁

**对于OpenClaw开发人员**：
您构建了技术上非凡的东西。237,000个GitHub星标反映了社区对开源AI助理愿景的真正热情。您所做的安全投入是真实且有意义的。但是当前架构将能力放在控制之前。在鼓励生产部署之前，优先考虑本报告中的第1层建议：插件沙箱、紧急停止、网络隔离、AI披露、链限制和标志限制。这些是可实现的变更，可以显著降低风险概况。

**对于OpenClaw用户**：
了解您正在部署什么。OpenClaw不是聊天机器人——它是一个自主代理，可以访问您的设备、您的通信、您的凭证和您的身份。以与授予某人远程桌面访问您的计算机相同的严肃性对待安装，因为技术能力是等效的。不要安装未经审查的插件。不要在敏感通道上启用自动回复。不要对已认证会话使用浏览器自动化。并且永远不要设置`dangerouslyDisable*`标志，除非您完全理解后果。

**对于监管者**：
AI个人助理已经部署在家庭、个人设备上，并管理人类通信。治理框架没有跟上。本研究中记录的问题——无披露的冒充、无同意的自主行动、无擦除的数据收集——不是假设的。它们是当前部署软件的架构特征。主动监管的时间是现在，在事件迫使反应性监管之前。

---

## 研究局限性

本报告必须在明确理解以下限制的情况下阅读：

1. **仅静态分析。** 本研究分析了通过GitHub API可访问的源代码结构、架构、配置文件和文档。没有执行OpenClaw代码。没有观察到运行时行为。系统在实践中的行为可能与代码结构建议的不同。

2. **无渗透测试。** 没有尝试利用任何已识别的漏洞。所有风险评估都基于架构分析，而不是演示的利用。实际可利用性可能高于或低于评估。

3. **仅公共存储库。** 分析仅限于公共GitHub存储库。未考虑公共存储库中不可见的私有安全措施、事件响应程序、内部安全审计或计划修复。

4. **时间点分析。** 本研究反映了截至2026年2月的代码库状态。OpenClaw正在积极开发中（237K星标，大型社区）。在阅读本报告时，此处识别的问题可能已经部分或完全解决。

5. **无开发人员咨询。** 在本研究期间未咨询开发团队。开发人员可以提供的关于设计决策、计划改进或代码中不可见的缓解因素的背景不可用。

6. **单一视角。** 虽然分析试图彻底和公正，但它代表了一个以安全为重点的视角。其他有效的视角（可用性、社区价值、教育效益、创新）没有得到充分体现。

7. **风险评分是主观的。** 严重性和可能性评估基于研究人员的判断，由行业框架告知但未独立验证。

尽管有这些限制，本研究中识别的架构模式代表了值得项目开发人员和用户关注的真正结构性风险。

---

## 附录：研究文档索引

| 文档 | 阶段 | 摘要 |
|---|---|---|
| 01-overview.md | 1 | 项目概述，关键特征 |
| 02-architecture.md | 1 | 技术架构，源代码地图 |
| 03-llm-providers.md | 1 | LLM提供商分析 |
| 04-ecosystem.md | 1 | 社区生态系统 |
| 05-risk-analysis-framework.md | 1 | 风险方法论 |
| 06-security-sandboxing.md | 2 | 安全与沙箱深度分析 |
| 07-plugin-supply-chain.md | 3 | 插件供应链分析 |
| 08-memory-data-analysis.md | 4 | 内存和数据收集 |
| 09-autonomy-consent.md | 5 | 自治性和同意差距 |
| 10-channel-impersonation.md | 6 | 通信冒充 |
| 11-browser-computer-use.md | 7 | 浏览器和计算机控制 |
| 12-ethical-assessment.md | 8 | 伦理和人类影响 |
| 13-comparison-best-practices.md | 9 | 标准比较 |
| **14-final-report.md** | **10** | **本文档** |

---

*研究由Tim Wu + Claude (Anthropic)于2026年2月进行。*
*分析基于公共源代码。未执行代码。*
*这是一项独立研究，与OpenClaw项目无关。*